# Easy Call AI 开发约定 (AGENT.md)

本文档描述当前项目的真实技术栈与开发约束，后续实现请以此为准。

## 1. 当前技术栈
- 桌面端: `Tauri 2 + Rust`
- 前端: `Vue 3 + TypeScript + Vite + DaisyUI`
- 包管理: `pnpm`
- 目标平台: Windows 优先（托盘 + 快捷键 + 无边框窗口）

## 2. 当前核心能力边界
- 配置窗口采用标签页: `快捷键 / API / 工具 / 人格 / 对话`
- 支持多 `API 配置` 持久化，支持独立 `对话 AI` 选择
- 消息支持文本与图片；语音走本地识别转文字，不走远程 STT
- 聊天窗口极简展示: 默认聚焦最新一轮，历史按需增量加载
- 支持工具调用（内置 `fetch / bing-search / memory-save`）与工具状态展示
- 支持思维链渲染（标准思维链 + 正文 `<think>`），并保留历史

## 3. Rust 开发原则
- 默认禁止 `unwrap()` / `expect()`（测试代码除外）
- 使用 `Result` 传递错误，错误信息需对用户可读
- 网络与 I/O 逻辑放异步，不阻塞 UI 交互
- 保持模块拆分，避免再次出现超大单文件
- 每次改动后优先保证 `cargo check` 可通过

## 4. 前端开发原则
- 使用 DaisyUI 组件优先，避免手写大段重复样式
- 配置页以“可感知保存”为准
- 有改动才允许保存，保存后状态立即回写
- 字段采用清晰标题，不堆叠冗余说明文案
- 对话窗口保持极简，不在主界面堆管理项
- 外链默认系统浏览器打开，不在应用内劫持跳转

## 5. 数据与安全
- 配置与会话数据使用统一应用数据目录持久化
- `.debug/` 目录用于本地调试配置，必须加入 `.gitignore`
- 严禁提交真实 `API Key`、用户隐私数据与本地缓存产物
- 记忆工具需遵守安全边界，不持久化高风险敏感信息

## 6. 提交流程约定
- 提交格式统一为: `<type>: <中文描述>`
- 允许类型: `feat` `fix` `refactor` `chore` `docs` `style` `test`
- 每次提交聚焦单一主题，避免“功能+重构+样式”混在一条
- 详细规范见 `CONTRIBUTING.md`

## 7. 目录认知
- `src/`: Vue 前端代码（窗口与状态管理）
- `src-tauri/src/app/`: Rust 业务模块（命令、对话、模型运行时、存储、窗口）
- `docs/`: 设计与运行文档
- `plan/`: 计划文档与需求拆解

## 8. 计划文档约定
- 每个新需求计划必须使用独立文件，放在 `plan/` 目录
- 不允许把新计划追加到已有计划文件（例如 `plan/plan.md`）
- 文件命名建议使用语义化英文下划线，例如：`avatar_persona_execution_plan.md`
